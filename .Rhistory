knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
# packages
require(tidyverse)
require(fixest)
require(stargazer)
require(haven)
library(usethis)
library(dplyr)
library(foreign)
library(gridExtra)
library(ggplot2)
library(openxlsx)
library(RODBC)
# clear
rm(list = ls())
# set directories
# directory_specific <-"C:/Research/LFP"
# set general data directory
directory_data <- "C:/Users/rbm7796/Dropbox/Iranian-Women-in-the-Workforce/Data"
# set specific data directories
directory_data_LFS <- file.path(directory_data,"/LFS")
# Load Data
setwd(directory_data_LFS)
# create empty dataframes
df_84_86 <- data.frame()
df_87_99<- data.frame()
# Loop through each file, read the data, and assign to a variable
for (i in 84:99) {
file <- paste0("LFS_", i, ".dta")
data <- read_dta(file)
data <- data[, order(names(data))]
# if i<87 merge data with df_84_86, else if i>87 merge data with df_87_99
if (i < 87) {
df_84_86 <- bind_rows(df_84_86, data)
} else {
if (i < 96) {
data <- subset(data, select = -IW15_Yearly)
names(data)[names(data) == "IW10_Yearly"] <- "IW_Yearly"
}
df_87_99 <- bind_rows(df_87_99, data)
}
}
# remove variable data
rm(data)
View(df_87_99)
#separate pkey column into 4 columns, first two digits are year, next two digits are province_code, next digit is if it is city/village, next three digit is the sample_number and the two last gigits are the family_number
df_87_89 <- df_87_99 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_84_86 <- df_84_86 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
View(df_87_99)
#separate pkey column into 4 columns, first two digits are year, next two digits are province_code, next digit is if it is city/village, next three digit is the sample_number and the two last gigits are the family_number
df_87_89 <- df_87_99 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_84_86 <- df_84_86 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
View(df_87_99)
#separate pkey column into 4 columns, first two digits are year, next two digits are province_code, next digit is if it is city/village, next three digit is the sample_number and the two last gigits are the family_number
df_87_89 <- df_87_99 %>%
separate(df_87_99$pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_87_89 <- df_87_99 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
View(df_87_89)
View(df_84_86)
knitr::opts_chunk$set(echo = TRUE)
# packages
require(tidyverse)
require(fixest)
require(stargazer)
require(haven)
library(usethis)
library(dplyr)
library(foreign)
library(gridExtra)
library(ggplot2)
library(openxlsx)
library(RODBC)
# clear
rm(list = ls())
# set directories
# directory_specific <-"C:/Research/LFP"
# set general data directory
directory_data <- "C:/Users/rbm7796/Dropbox/Iranian-Women-in-the-Workforce/Data"
# set specific data directories
directory_data_LFS <- file.path(directory_data,"/LFS")
# packages
require(tidyverse)
require(fixest)
require(stargazer)
require(haven)
library(usethis)
library(dplyr)
library(foreign)
library(gridExtra)
library(ggplot2)
library(openxlsx)
library(RODBC)
# clear
rm(list = ls())
# set directories
# directory_specific <-"C:/Research/LFP"
# set general data directory
directory_data <- "C:/Users/rbm7796/Dropbox/Iranian-Women-in-the-Workforce/Data"
# set specific data directories
directory_data_LFS <- file.path(directory_data,"/LFS")
# Load Data
setwd(directory_data_LFS)
# create empty dataframes
df_84_86 <- data.frame()
df_87_99<- data.frame()
# Loop through each file, read the data, and assign to a variable
for (i in 84:99) {
file <- paste0("LFS_", i, ".dta")
data <- read_dta(file)
data <- data[, order(names(data))]
# if i<87 merge data with df_84_86, else if i>87 merge data with df_87_99
if (i < 87) {
df_84_86 <- bind_rows(df_84_86, data)
} else {
if (i < 96) {
data <- subset(data, select = -IW15_Yearly)
names(data)[names(data) == "IW10_Yearly"] <- "IW_Yearly"
}
df_87_99 <- bind_rows(df_87_99, data)
}
}
View(df_87_99)
View(df_87_99)
View(df_87_99)
View(data)
View(data)
# remove variable data
rm(data)
knitr::opts_chunk$set(echo = TRUE)
# packages
require(tidyverse)
require(fixest)
require(stargazer)
require(haven)
library(usethis)
library(dplyr)
library(foreign)
library(gridExtra)
library(ggplot2)
library(openxlsx)
library(RODBC)
# clear
rm(list = ls())
# set directories
# directory_specific <-"C:/Research/LFP"
# set general data directory
directory_data <- "C:/Users/rbm7796/Dropbox/Iranian-Women-in-the-Workforce/Data"
# set specific data directories
directory_data_LFS <- file.path(directory_data,"/LFS")
# Load Data
setwd(directory_data_LFS)
# create empty dataframes
df_84_86 <- data.frame()
df_87_99<- data.frame()
# Loop through each file, read the data, and assign to a variable
for (i in 84:99) {
file <- paste0("LFS_", i, ".dta")
data <- read_dta(file)
data <- data[, order(names(data))]
# if i<87 merge data with df_84_86, else if i>87 merge data with df_87_99
if (i < 87) {
df_84_86 <- bind_rows(df_84_86, data)
} else {
if (i < 96) {
data <- subset(data, select = -IW15_Yearly)
names(data)[names(data) == "IW10_Yearly"] <- "IW_Yearly"
}
df_87_99 <- bind_rows(df_87_99, data)
}
}
# remove variable data
rm(data)
View(df_84_86)
df_87_89 <- df_87_99 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_84_86 <- df_84_86 %>%
separate(df_84_86$pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_84_86 <- df_84_86 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
#separate pkey column into 4 columns, first two digits are year, next two digits are province_code, next digit is if it is city/village, next three digit is the sample_number and the two last gigits are the family_number
df_87_99 <- df_87_99 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_84_86 <- df_84_86 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
knitr::opts_chunk$set(echo = TRUE)
# packages
require(tidyverse)
require(fixest)
require(stargazer)
require(haven)
library(usethis)
library(dplyr)
library(foreign)
library(gridExtra)
library(ggplot2)
library(openxlsx)
library(RODBC)
# clear
rm(list = ls())
# set directories
# directory_specific <-"C:/Research/LFP"
# set general data directory
directory_data <- "C:/Users/rbm7796/Dropbox/Iranian-Women-in-the-Workforce/Data"
# set specific data directories
directory_data_LFS <- file.path(directory_data,"/LFS")
# Load Data
setwd(directory_data_LFS)
# create empty dataframes
df_84_86 <- data.frame()
df_87_99<- data.frame()
# Loop through each file, read the data, and assign to a variable
for (i in 84:99) {
file <- paste0("LFS_", i, ".dta")
data <- read_dta(file)
data <- data[, order(names(data))]
# if i<87 merge data with df_84_86, else if i>87 merge data with df_87_99
if (i < 87) {
df_84_86 <- bind_rows(df_84_86, data)
} else {
if (i < 96) {
data <- subset(data, select = -IW15_Yearly)
names(data)[names(data) == "IW10_Yearly"] <- "IW_Yearly"
}
df_87_99 <- bind_rows(df_87_99, data)
}
}
# remove variable data
rm(data)
knitr::opts_chunk$set(echo = TRUE)
# packages
require(tidyverse)
require(fixest)
require(stargazer)
require(haven)
library(usethis)
library(dplyr)
library(foreign)
library(gridExtra)
library(ggplot2)
library(openxlsx)
library(RODBC)
# clear
rm(list = ls())
# set directories
# directory_specific <-"C:/Research/LFP"
# set general data directory
directory_data <- "C:/Users/rbm7796/Dropbox/Iranian-Women-in-the-Workforce/Data"
# set specific data directories
directory_data_LFS <- file.path(directory_data,"/LFS")
# Load Data
setwd(directory_data_LFS)
# create empty dataframes
df_84_86 <- data.frame()
df_87_99<- data.frame()
# Loop through each file, read the data, and assign to a variable
for (i in 84:99) {
file <- paste0("LFS_", i, ".dta")
data <- read_dta(file)
data <- data[, order(names(data))]
# if i<87 merge data with df_84_86, else if i>87 merge data with df_87_99
if (i < 87) {
df_84_86 <- bind_rows(df_84_86, data)
} else {
if (i < 96) {
data <- subset(data, select = -IW15_Yearly)
names(data)[names(data) == "IW10_Yearly"] <- "IW_Yearly"
}
df_87_99 <- bind_rows(df_87_99, data)
}
}
# remove variable data
rm(data)
#separate pkey column into 4 columns, first two digits are year, next two digits are province_code, next digit is if it is city/village, next three digit is the sample_number and the two last gigits are the family_number
df_87_99_subset <- df_87_99 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_84_86_subset <- df_84_86 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
# rename colunm F2_D04 to gender
colnames(df_87_99_subset)[colnames(df_87_99_subset) == "F2_D04"] <- "gender"
# keep only rows with value 2 in column gender
df_87_99_subset <- df_87_99_subset %>%
filter(gender == 2)
#separate pkey column into 4 columns, first two digits are year, next two digits are province_code, next digit is if it is city/village, next three digit is the sample_number and the two last gigits are the family_number
df_87_99_subset <- df_87_99 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
df_84_86_subset <- df_84_86 %>%
separate(pkey, into = c("year", "province_code", "city_village", "sample_number", "family_number"),
sep = c(2, 4, 5, 8))
# rename colunm F2_D04 to gender
colnames(df_87_99_subset)[colnames(df_87_99_subset) == "F2_D04"] <- "gender"
colnames(df_87_99_subset)[colnames(df_87_99_subset) == "F2_D07"] <- "age"
colnames(df_87_99_subset)[colnames(df_87_99_subset) == "F2_D08"] <- "citizenship"
# keep only rows with value 2 in column gender
df_87_99_subset <- df_87_99_subset %>%
filter(citizenship==1) %>% filter(age > 16 & age < 64)
# if at least one of F3_D01 to F3_D06 is 1, then employed=1, else employed=0
df_87_99_subset <- df_87_99_subset %>%
mutate(employed = if_else(F3_D01 == 1 | F3_D02 == 1 | F3_D03 == 1 | F3_D04 == 1 | F3_D05 == 1 | F3_D06 == 1, 1, 0))
df_99_subset <- df_87_99_subset %>%
filter(year==99)
# by province_code and gender, take average on employed
df_99_subset_avg <- df_99_subset %>%
group_by(province_code, gender) %>%
summarize(avg_employed = mean(employed))
View(df_99_subset_avg)
df_99_subset_avg_wide <- df_99_subset_avg %>%
pivot_wider(names_from = gender, values_from = employed, names_prefix = "employed_gender_")
View(df_99_subset_avg)
df_99_subset_avg_wide <- df_99_subset_avg %>%
pivot_wider(names_from = gender, values_from = avg_employed, names_prefix = "avg_employed_gender_")
View(df_99_subset_avg_wide)
df_99_subset_avg_wide <- df_99_subset_avg_wide %>%
arrange(avg_employed_gender_2)
View(df_99_subset_avg_wide)
province_list <- read_xlsx(province_names)
province_list <- read.xlsx(province_names)
province_list <- read.xlsx(province_names.xlsx, sheet = 1)
setwd(directory_data_LFS)
province_list <- read.xlsx(province_names.xlsx, sheet = 1)
setwd(directory_data)
province_list <- read.xlsx(province_names.xlsx, sheet = 1)
setwd(directory_data)
province_list <- read.xlsx(province_names.xlsx, sheet = 1)
setwd(directory_data)
province_list <- read.xlsx(province_names.xlsx, sheet = 1)
setwd(directory_data)
province_list <- read.xlsx(province_names.xlsx)
library(openxlsx)
setwd(directory_data)
province_list <- read.xlsx(province_names.xlsx)
setwd(directory_data)
print(getwd())
province_list <- read.xlsx(province_names.xlsx)
directory_data <- "C:/Users/rbm7796/Dropbox/Iranian-Women-in-the-Workforce/Data/"
setwd(directory_data)
print(getwd())
province_list <- read.xlsx(province_names.xlsx)
